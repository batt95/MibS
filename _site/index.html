<!DOCTYPE html>
<html lang="en">
	<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Quick Start</title>
  <meta name="description" content="MibS Documentation">

	<link rel="icon" href="/assets/images/favicon.ico">
  <link rel="canonical" href="https://coin-or.github.io/MibS/">

	<link rel="stylesheet" href="/assets/css/docs.css">

</head>

	<body>
		<div class="wrapper">
			<sidebar class="sidebar" id="sidebar">
	<div class="sidebar-mobile">
		<img src="/assets/images/menu.svg" class="menu-icon" id="menu" />
		<img src="/assets/images/close.svg" class="close-icon" id="close" />
	</div>
	<div class="search">
	<input type="text" class="search-input" id="search-input" placeholder="Type to search" />
</div>

	<div class="sidebar-main">
		<ul class="navigation" id="navigation">																			<li>				<a class="active" href="/">					Quick Start				</a>			</li>								<li>				<a class="" href="/parameters.html">					Parameters				</a>			</li>								<li>				<a class="" href="/input.html">					File Format				</a>			</li>			</ul>

		<ul id="search-results" class="navigation"></ul>

	</div>
</sidebar>

			<main class="content">
				<div class="inner">
					<h1 id="mibs-quick-start">MibS Quick Start</h1>

<h2 id="versions">Versions</h2>

<p><code>MibS</code> uses <a href="https://semver.org/">semantic versioning</a> (major.minor.patch). There are three major
versions of <code>MibS</code> currently under development.</p>

<ul>
  <li>Versions with major number 1 are recommended for most users. This is the
original solver, which is focused on solution of <em>deterministic</em> mixed integer
bilevel linear optimization problems (MIBLPs). The latest minor version in
this series is <a href="https://github.com/coin-or/MibS/tree/stable/1.2">1.2</a> and
the most recent release is
<a href="https://github.com/coin-or/MibS/releases"><img src="https://img.shields.io/github/v/release/coin-or/MibS?sort=semver" alt="Latest Release" /></a>.</li>
  <li>The version in the <a href="https://github.com/coin-or/MibS/tree/master">master</a>
branch will become major version 2 and can additionally solve <em>stochastic</em>
MIBLPs. Once released, this version will subsume all capabilities of version 1
and version 1 will be deprecated. It has not yet had a release, but is well tested.</li>
  <li>There is also a major verion 3 of <code>MibS</code> under development that incorporates the
ability to solve MIBLPs under the assumption of <em>bounded rationality</em>.</li>
</ul>

<h2 id="building-and-installing">Building and Installing</h2>

<p>For information on building and installing <code>MibS</code> on different platforms, see
the README for the appropriate version, e.g.,
<a href="https://github.com/coin-or/MibS/tree/stable/1.2#building-from-source">here</a>
(procedure is similar for all versions), or the more detailed <a href="https://coin-or.github.io/user_introduction.html">COIN-OR User
Guide</a>.</p>

<h2 id="using">Using</h2>

<p>To understand how to use <code>MibS</code>, it helps to know that <code>MibS</code> is built on top of
the <a href="https://github.com/coin-or/CHiPPS-BLIS">BLIS</a> MILP solver, which is in
turn implemented using the (COIN-OR High-Performance Parallel Search (CHiPPS)
Framework and more specifically with the [Abstract Library for Parallel Search
<a href="https://github.com/coin-or/CHiPPS-ALPS">ALPS</a>, a library of abstract base
classes for implementing parallel search algorithms. You can find a detailed
description of the algorithms and the important parameters of major version 1
of <code>MibS</code>
<a href="https://arxiv.org/abs/2104.09010http://www.optimization-online.org/DB_FILE/2017/04/5977.pdf">here</a>.</p>

<h3 id="modelling-systems">Modelling Systems</h3>

<p>MibS has interfaces to the following modelling systems that allow the user to
conveniently build the bilevel model in a high-level modelling language and
pass the model to MibS through the interface for solution.</p>

<ul>
  <li>Pyomo (Python) through the
<a href="https://pao.readthedocs.io/en/latest/index.html#">PAO</a> package,
see <a href="https://pao.readthedocs.io/en/latest/solvers.html">here</a></li>
  <li>JuMP (Julia) through the <a href="https://github.com/joaquimg/BilevelJuMP.jl">BilevelJuMP</a> package, see
<a href="https://github.com/joaquimg/BilevelJuMP.jl/blob/master/docs/src/examples/MibS_example1.jl">here</a>
for an example.</li>
</ul>

<h3 id="basic-command-line-usage">Basic Command-line Usage</h3>

<p>The command-line on all platforms consists of the executable name <code>mibs</code>
followed by a list of parameters and values. Some of the parameters are <code>MibS</code>
parameters, but parameters of ALPS and BLIS are also necessary.</p>

<h4 id="version-1">Version 1</h4>

<p>To solve a deterministic mixed integer bilevel linear optimization problem
with <code>MibS</code> version 1, you must provide both an MPS, LP, or GMPL/AMPL file and
an auxiliary information file that specifies which variables and constraints
are associated with the each level (see
<a href="http://coral.ise.lehigh.edu/wp-content/uploads/2016/02/MibS_inputFile.pdf">here</a>).
Then call <code>mibs</code> like this:</p>
<pre><code class="language-bash">dist/bin/mibs -Alps_instance file.mps -MibS_auxiliaryInfoFile file.aux
</code></pre>
<p>Note that the second parameters is unnecessary if the auxiliary file has the
same base name and is in the same folder.</p>

<p><code>MibS</code> has many additional parameters, many of which are documented
<a href="parameters.html">here</a>. See the example parameter file <code>mibs.par</code> and the
header file <code>MibParams.hpp</code> for additional information. 
It is also possible to
specify additional settings in a parameter file with, e.g.,</p>
<pre><code class="language-bash">dist/bin/mibs -param MibS/src/mibs.par 
</code></pre>

<h4 id="version-2">Version 2</h4>

<p>Major version 2 of<code>MibS</code> is additionally capable of solving two-stage mixed
integer stochastic bilevel linear optimization problems. There are two
different ways to specify such problems to <code>MibS</code>.</p>

<ul>
  <li>Provide an MPS file, a time file and a stoch file in the same way as the
<a href="http://www.maximalsoftware.com/resources/GassmannKristjansson_dpm007v1.pdf">SMPS</a>
format. The second-stage objective coefficients should be defined at the
end of the time file (see
<a href="https://github.com/tkralphs/BilevelLib/blob/master/stochastic/sslp/bilevel_nonZeroSum_sslp_10_50_50.tim">here</a>).
For this instance format, call <code>mibs</code> like this:
    <pre><code class="language-bash">dist/bin/mibs -Alps_instance file.mps -MibS_auxiliaryTimFile file.tim -MibS_auxiliaryStoFile file.sto -MibS_stochasticityType stochasticWithoutSAA -MibS_isSMPSFormat 1 -MibS_isA2Random 1 
</code></pre>
    <p>The parameter <code>MibS_isA2Random</code> should be set to 0 in case the
coefficients of the first-stage variables in the second-stage problem are
not random variables.</p>
  </li>
  <li>Provide an MPS file and an auxiliary information file in the same way as
deterministic bilevel problems. In this case, the probability
distributions of the random variables must also be specified by setting
the values of corresponding parameters (<code>MibS</code> currently supports only the
discrete uniform distribution). For a sample parameter file, see
[https://github.com/coin-or/MibS/blob/master/src/mibsStochastic.par.in].</li>
</ul>

<h3 id="the-c-api">The C++ API</h3>

<p>Major versions 1 and 2 both have a C++ class library that can be used to link
to the MibS from another application. The main class user interact with is the
<code>MibSModel</code> class. Below is a short code snippet showing how to pass instance
data to MibS in memory from another application. As described above, MibS is
ultimately built on the abstract base classes of
<a href="https://github.com/coin-or/CHiPPS-ALPS">ALPS</a> and hence the solve call is
actually invoked by calling the <code>search</code> method of the <code>AlpsKnowledgeBroker</code>
object. (In the future, we plan to wrap all of this in order to make
invocation simpler to understand).</p>

<pre><code class="language-cpp">#include &lt;iostream&gt;

#include "OsiSolverInterface.hpp"
#include "OsiClpSolverInterface.hpp"

#include "MibSConfig.hpp"
#include "MibSModel.hpp"

#include "AlpsKnowledgeBrokerSerial.h"

int main(int argc, char* argv[])
{
   /** Set up lp solver **/
   OsiClpSolverInterface lpSolver;
   lpSolver.messageHandler()-&gt;setLogLevel(0);
      
   /** Create MibS model **/
   MibSModel model;
   model.setSolver(&amp;lpSolver);

   /****************************************************************/
   /*                                                              */
   /* Add code here that fills in the data structures needed for   */
   /* the functions below.                                          */
   /*                                                              */
   /****************************************************************/

   /* The auxiliary data describes which rows and variables in the */
   /* upper level and which are in the lower level, as well as     */
   /* specifying the lower-level objective function                */
   
   model-&gt;loadAuxiliaryData(lowerColNum, lowerRowNum, lowerColInd,
                            lowerRowInd, 1.0, lObjCoeff,
                            upperColNum, upperRowNum, upperColInd,
                            upperRowInd, structRowNum, structRowInd,
                            0, NULL, lColLbInLProb, lColUbInLProb);

   /* The problem data itself is passed in as a CoinPackedMatrix,  */
   /* vectors of upper and lower bounds, etc., as usual for an     */
   /* MILP solver                                                  */
   
   model-&gt;loadProblemData(*newMatrix, varLB, varUB, objCoef, conLB,
                          conUB, colType, 1, mps-&gt;getInfinity(),
                          rowSense);

   int argc = 1;
   char** argv = new char* [1];
   argv[0] = "mibs";

   /* Create the knowledge broker to do the actual search. argc */
   /* argv are passed in to parse the arguments                 */
   
   AlpsKnowledgeBrokerSerial broker(argc, argv, model);

   /** This is the function that does the solve **/
   
   broker.search(model);

   /** Get the solution **/

   if (model-&gt;getNumSolutions() == 0){
      std::cout &lt;&lt; "MibS did not find any bilevel feasible solutions. "
               &lt;&lt; std::endl;
      abort();
   }

   MibSSolution *solution = dynamic_cast&lt;MibSSolution* &gt;
      (broker.getBestKnowledge(AlpsKnowledgeTypeSolution).first);
   
   double *y = new double[upperColNum];
   
   for (j = lowerColNum; j &lt; numTotalCols; j++){
      y[j - lowerColNum] = floor(solution-&gt;getValues()[j] + 0.5);
   }
}
</code></pre>

<p>There are also function in <code>MibSModel</code> for directly parsing MPS/LP/AMPL/GMPL
files, as well as axiliary files if thoe are to be read directly. See
<a href="https://github.com/coin-or/MibS/blob/master/src/MibSModel.hpp">MibSModel.hpp</a>.</p>

				</div>
			</main>
		</div>
		<script src="/assets/js/zepto.min.js"></script>
<script src="/assets/js/lunar.min.js"></script>
<script src="/assets/js/prism.min.js"></script>
<script src="/assets/js/database.js"></script>
<script src="/assets/js/search.js"></script>
<script src="/assets/js/mobile-navigation.js"></script>

	</body>
</html>
